class DrawSpace{constructor(e,t){this.stage=new createjs.Stage(document.createElement("canvas")),this.stage.canvas.width=e,this.stage.canvas.height=t,this.texture=new THREE.Texture(this.stage.canvas),this.drawing=new createjs.Shape,this.stage.addChild(this.drawing),this.pen={color:"#ff00ff",size:10},this.stopDrawing(),this.stage.update(),this.texture.needsUpdate=!0}setSize(e,t){this.stage.canvas.width=t,this.stage.canvas.height=e}startDrawing(e,t){this.pen.active=!0,this.draw(e,t)}stopDrawing(e,t){!this.pen.moved&&e&&t&&this.draw(e,t),this.pen.active=!1,this.pen.moved=!1,this.pen.x=this.pen.y=null}draw(e,t){e=this.stage.canvas.width/2+e,t=this.stage.canvas.height/2-t,this.pen.active&&(this.pen.x&&(this.moved=!0,this.drawing.graphics.beginStroke(this.pen.color).setStrokeStyle(this.pen.size,"round").moveTo(this.pen.x||e,this.pen.y||t).lineTo(e,t),this.stage.update(),this.texture.needsUpdate=!0),this.pen.x=e,this.pen.y=t)}createMesh(){if(this.canvasMesh)return this.canvasMesh;var e=new THREE.Mesh(new THREE.BoxGeometry(this.stage.canvas.width,this.stage.canvas.height,1),new THREE.MeshBasicMaterial({color:"white"})),t=new THREE.Mesh(new THREE.BoxGeometry(this.stage.canvas.width,this.stage.canvas.height,.1),new THREE.MeshBasicMaterial({map:this.texture,transparent:!0}));return e.add(t),t.position.set(0,0,e.scale.z/2+t.scale.z/2),this.drawingMesh=t,this.canvasMesh=e,e}}
var renderer=new THREE.WebGLRenderer;renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement);var scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);camera.position.set(0,0,400),camera.lookAt(0,0,0),window.onresize=function(){var e=window.innerWidth,n=window.innerHeight;renderer&&(renderer.setSize(e,n),camera.aspect=e/n,camera.updateProjectionMatrix())};var spotLight=new THREE.SpotLight(16777215);spotLight.position.set(600,600,600),scene.add(spotLight);var drawingSpace=new DrawSpace(640,480);function screenToWorld(e,n,o=0){var r=new THREE.Vector3,a=new THREE.Vector3;r.set(e/window.innerWidth*2-1,-n/window.innerHeight*2+1,.5),r.unproject(camera),r.sub(camera.position).normalize();var i=(o-camera.position.z)/r.z;return a.copy(camera.position).add(r.multiplyScalar(i)),a}function update(){requestAnimationFrame(update),renderer.render(scene,camera)}window.ontouchstart=function(e){Array(...e.touches).forEach(window.onmousedown)},window.ontouchmove=function(e){console.log(e),Array(...e.touches).forEach(window.onmousemove)},window.ontouchcancel=window.ontouchend=function(e){0==e.touches.length&&drawingSpace.stopDrawing(),Array(...e.touches).forEach(window.onmouseup)},window.onmousedown=function(e){var n=screenToWorld(e.pageX,e.pageY);drawingSpace.startDrawing(n.x,n.y)},window.onmouseup=function(e){var n=screenToWorld(e.pageX,e.pageY);drawingSpace.stopDrawing(n.x,n.y)},window.onmousemove=function(e){var n=screenToWorld(e.pageX,e.pageY);drawingSpace.draw(n.x,n.y)},scene.add(drawingSpace.createMesh()),update();
//# sourceMappingURL=game.min.js.map
